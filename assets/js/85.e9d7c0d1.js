(window.webpackJsonp=window.webpackJsonp||[]).push([[85],{539:function(t,a,s){"use strict";s.r(a);var n=s(31),r=Object(n.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"关键词"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#关键词"}},[t._v("#")]),t._v(" 关键词")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("同源策略")]),t._v(" "),s("p",[t._v("浏览器故意设计的一个功能限制")])]),t._v(" "),s("li",[s("p",[t._v("CORS")]),t._v(" "),s("p",[t._v("突破浏览器限制的一个方法")])]),t._v(" "),s("li",[s("p",[t._v("JSONP")]),t._v(" "),s("p",[t._v("IE时代妥协的产物")])])]),t._v(" "),s("h2",{attrs:{id:"同源策略"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#同源策略"}},[t._v("#")]),t._v(" 同源策略")]),t._v(" "),s("h3",{attrs:{id:"什么是源"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#什么是源"}},[t._v("#")]),t._v(" 什么是源")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("使用 window.origin 或 location.origin 可以得到当前页面的源")])]),t._v(" "),s("li",[s("p",[t._v("源 = 协议 + 域名 + 端口号")])])]),t._v(" "),s("h3",{attrs:{id:"什么是同源"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#什么是同源"}},[t._v("#")]),t._v(" 什么是同源")]),t._v(" "),s("p",[t._v("如果两个 url 的"),s("strong",[t._v("协议")]),t._v("、"),s("strong",[t._v("域名")]),t._v("、"),s("strong",[t._v("端口号")]),t._v("完全一致，那么这两个 url 就是同源的")]),t._v(" "),s("p",[t._v("举例")]),t._v(" "),s("div",{staticClass:"language-http extra-class"},[s("pre",{pre:!0,attrs:{class:"language-http"}},[s("code",[s("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("https:")]),t._v("//www.qq.com/ 和 https://www.baidu.com/ 不同源\n\n"),s("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("https:")]),t._v("//baidu.com/ 和 https://www.baidu.com/ 不同源\n")])])]),s("h3",{attrs:{id:"什么是同源策略"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#什么是同源策略"}},[t._v("#")]),t._v(" 什么是同源策略")]),t._v(" "),s("p",[t._v("如果JS运行在源A里，那么就只能获取源A的数据，不能获取源B的数据，即不允许跨域。")]),t._v(" "),s("p",[t._v("就是不同源的页面之间的JS，不准互相请求数据。")]),t._v(" "),s("p",[t._v("除了同源策略，其实根据请求头(Request Headers)的"),s("code",[t._v("referer")]),t._v("，也可以判断请求是否为当前域名。")]),t._v(" "),s("p",[t._v("https://uphg.github.io/images/blog-referer.jpg")]),t._v(" "),s("h2",{attrs:{id:"什么是跨域"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#什么是跨域"}},[t._v("#")]),t._v(" 什么是跨域")]),t._v(" "),s("p",[t._v("当前页面下的JS发起的 AJAX 请求，一般情况下该请求只能是当前页面下同域名的请求，如果请求其他域名下内容就叫做跨域。")]),t._v(" "),s("h3",{attrs:{id:"为什么a-qq-com访问qq-com也算跨域"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#为什么a-qq-com访问qq-com也算跨域"}},[t._v("#")]),t._v(" 为什么a.qq.com访问qq.com也算跨域？")]),t._v(" "),s("p",[t._v("因为历史上出现过不同公司共用域名。a.qq.com 和 qq.com 不一定是同一个网站，浏览器为了谨慎起见，认为这是不同源。")]),t._v(" "),s("h3",{attrs:{id:"为什么不同端口也算跨域"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#为什么不同端口也算跨域"}},[t._v("#")]),t._v(" 为什么不同端口也算跨域？")]),t._v(" "),s("p",[t._v("一个端口一个公司。记住安全链条的强度取决于最弱的一环，任何安全相关的问题都要谨慎对待（就是浏览器限制比较严格）")]),t._v(" "),s("h3",{attrs:{id:"为什么两个网站的ip是一样的-也算跨域"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#为什么两个网站的ip是一样的-也算跨域"}},[t._v("#")]),t._v(" 为什么两个网站的IP是一样的，也算跨域？")]),t._v(" "),s("p",[t._v("原因同上，IP可以公用（还是浏览器限制比较严格）")]),t._v(" "),s("h3",{attrs:{id:"为什么可以跨域使用css、js和图片等"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#为什么可以跨域使用css、js和图片等"}},[t._v("#")]),t._v(" 为什么可以跨域使用CSS、JS和图片等")]),t._v(" "),s("p",[t._v("同源策略限制的是数据访问，我们引用CSS、JS和图片的时候，其实并不知道里面的内容是什么，我们只是在引用。并不能通过AJAX请求拿到里面的数据。")]),t._v(" "),s("p",[t._v("可以看作是我们只是获取到它呈现的样子，并不是它本身的数据。")]),t._v(" "),s("h2",{attrs:{id:"使用cors解决跨域问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用cors解决跨域问题"}},[t._v("#")]),t._v(" 使用CORS解决跨域问题")]),t._v(" "),s("p",[t._v("响应首部中可以携带一个 Access-Control-Allow-Origin 字段，其语法如下:")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("Access-Control-Allow-Origin: http://mozilla.com\n")])])]),s("blockquote",[s("p",[t._v("表示允许来自 http://mozilla.com 的请求")])]),t._v(" "),s("p",[t._v("MDN文档: https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS#简单请求")]),t._v(" "),s("h2",{attrs:{id:"使用jsonp兼容ie跨域"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用jsonp兼容ie跨域"}},[t._v("#")]),t._v(" 使用JSONP兼容IE跨域")]),t._v(" "),s("p",[s("strong",[t._v("JSONP 和 JSON 并没有任何关系")])]),t._v(" "),s("p",[t._v("我的理解：JSONP 就是利用后台在当前域名下的JS文件中动态写入一个JS数据，将这个数据传入 window.xxx 函数中("),s("code",[t._v("window.xxx(数据)")]),t._v(")，其他域名需要跨域访问时就动态引入一个script标签将当前域名下的JS文件引入，引入后调用 window.xxx 函数，即可访问当前域名下的数据")]),t._v(" "),s("p",[s("strong",[t._v("封装一个JSONP函数")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("jsonp")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("url")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Promise")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("resolve"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" reject")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" random "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"chenJSONPCallbackName"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" Math"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("random")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        window"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("random"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("data")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" script "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createElement")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'script'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 此处的 callback 是前后端默认约定俗成的名称")]),t._v("\n        script"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("src "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("url"),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("?callback=")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("random"),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),t._v("\n        script"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onload")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 如果请求成功,就删除 script 标签")]),t._v("\n            script"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        script"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onerror")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 如果请求失败就返回 reject() 函数")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("reject")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        document"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("appendChild")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("script"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 使用")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("jsonp")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://qq.com/main.js'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("data")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h2",{attrs:{id:"总结"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[t._v("#")]),t._v(" 总结")]),t._v(" "),s("h3",{attrs:{id:"什么是jsonp"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#什么是jsonp"}},[t._v("#")]),t._v(" 什么是JSONP？")]),t._v(" "),s("p",[t._v("JSONP 就是由于我们需要跨域请求时，当前浏览器不支持 CORS 或不兼容 CORS 等其他原因，我们必须使用另外一种方式来跨域。")]),t._v(" "),s("p",[t._v("于是我们就跨域请求一个 JS 文件，这个 JS 文件会执行一个回调，回调里面就有我们需要的数据，回调的名称是可以随机生成的，可以给一个随机数，然后把这个名字用一个名叫 callback 参数传给后台，后台会把这个函数再次返回给我们并执行。")]),t._v(" "),s("p",[t._v("优点: 兼容IE，它可以跨域。")]),t._v(" "),s("p",[t._v("缺点: 由于它是利用 script 标签获取，所以它只能发送GET请求，它不支持POST请求。")]),t._v(" "),s("h3",{attrs:{id:"什么是跨域-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#什么是跨域-2"}},[t._v("#")]),t._v(" 什么是跨域？")]),t._v(" "),s("p",[t._v("域名A下的JS想通过AJAX请求域名B的数据，就叫做跨域。")]),t._v(" "),s("h3",{attrs:{id:"什么是cors"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#什么是cors"}},[t._v("#")]),t._v(" 什么是CORS？")]),t._v(" "),s("p",[t._v("CORS就是用来解决跨域请求的一种方式，在响应头携带一个 Access-Control-Allow-Origin 字段，表明指定的域名可以访问该网站。")]),t._v(" "),s("h2",{attrs:{id:"拓展"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#拓展"}},[t._v("#")]),t._v(" 拓展")]),t._v(" "),s("h3",{attrs:{id:"json数据可视化插件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#json数据可视化插件"}},[t._v("#")]),t._v(" JSON数据可视化插件")]),t._v(" "),s("p",[t._v("去 Chrome 网上应用店下载 "),s("code",[t._v("JSON Viewer")]),t._v(" 插件")])])}),[],!1,null,null,null);a.default=r.exports}}]);